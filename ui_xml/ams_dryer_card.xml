<?xml version="1.0"?>
<!-- Copyright 2025 HelixScreen -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<component>
  <consts>
    <!-- Progress bar height -->
    <px name="progress_height" value="8"/>
  </consts>
  <view name="ams_dryer_card"
        extends="lv_obj" width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0"
        scrollable="false" flex_flow="column" style_pad_gap="#space_sm">
    <!-- Hidden when dryer not supported -->
    <bind_flag_if_eq subject="dryer_supported" flag="hidden" ref_value="0"/>
    <!-- Section Header -->
    <text_body width="100%" text="Dryer"/>
    <!-- Dryer Status Card -->
    <ui_card name="dryer_status_card"
             width="100%" height="content" style_radius="#border_radius_large" style_pad_all="#space_md"
             flex_flow="column" style_flex_main_place="start" style_flex_cross_place="stretch" style_pad_gap="#space_sm">
      <!-- Temperature Display Row -->
      <lv_obj name="temp_row"
              width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="row"
              style_flex_main_place="space_between" style_flex_cross_place="center" scrollable="false">
        <!-- Current → Target display -->
        <lv_obj width="content"
                height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="row"
                style_flex_cross_place="center" style_pad_gap="#space_xs" scrollable="false">
          <text_heading name="dryer_current_temp_label" bind_text="dryer_current_temp_text"/>
          <text_body text="→" style_text_color="#text_secondary"/>
          <text_heading name="dryer_target_temp_label" bind_text="dryer_target_temp_text"/>
        </lv_obj>
        <!-- Time remaining -->
        <text_body name="dryer_time_label" bind_text="dryer_time_text" style_text_color="#text_secondary"/>
      </lv_obj>
      <!-- Progress Bar (only visible when drying) -->
      <lv_obj name="progress_container"
              width="100%" height="#progress_height" style_bg_color="#text_secondary" style_bg_opa="38"
              style_radius="#border_radius_small" style_border_width="0" style_pad_all="0" scrollable="false">
        <!-- Hidden when not drying -->
        <bind_flag_if_eq subject="dryer_active" flag="hidden" ref_value="0"/>
        <!-- Progress fill bar -->
        <lv_obj name="progress_fill"
                height="100%" style_bg_color="#success_color" style_bg_opa="255" style_radius="#border_radius_small"
                style_border_width="0" style_pad_all="0" scrollable="false">
          <!-- Width bound to progress_pct via C++ -->
        </lv_obj>
      </lv_obj>
      <!-- Preset Buttons (hidden when drying is active) -->
      <lv_obj name="preset_buttons"
              width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="row"
              style_flex_main_place="space_between" style_pad_gap="#space_xs" scrollable="false">
        <!-- Hidden when drying is active -->
        <bind_flag_if_eq subject="dryer_active" flag="hidden" ref_value="1"/>
        <lv_button name="btn_preset_pla"
                   height="#button_height_small" flex_grow="1" style_radius="#border_radius_small"
                   style_border_width="0" style_shadow_width="0">
          <lv_obj width="100%"
                  height="100%" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="column"
                  style_flex_main_place="center" style_flex_cross_place="center" scrollable="false" clickable="false">
            <text_small text="PLA"/>
            <text_small text="45°C" style_text_color="#text_secondary"/>
          </lv_obj>
          <event_cb trigger="clicked" callback="dryer_preset_pla_cb"/>
        </lv_button>
        <lv_button name="btn_preset_petg"
                   height="#button_height_small" flex_grow="1" style_radius="#border_radius_small"
                   style_border_width="0" style_shadow_width="0">
          <lv_obj width="100%"
                  height="100%" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="column"
                  style_flex_main_place="center" style_flex_cross_place="center" scrollable="false" clickable="false">
            <text_small text="PETG"/>
            <text_small text="55°C" style_text_color="#text_secondary"/>
          </lv_obj>
          <event_cb trigger="clicked" callback="dryer_preset_petg_cb"/>
        </lv_button>
        <lv_button name="btn_preset_abs"
                   height="#button_height_small" flex_grow="1" style_radius="#border_radius_small"
                   style_border_width="0" style_shadow_width="0">
          <lv_obj width="100%"
                  height="100%" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="column"
                  style_flex_main_place="center" style_flex_cross_place="center" scrollable="false" clickable="false">
            <text_small text="ABS"/>
            <text_small text="65°C" style_text_color="#text_secondary"/>
          </lv_obj>
          <event_cb trigger="clicked" callback="dryer_preset_abs_cb"/>
        </lv_button>
      </lv_obj>
      <!-- Stop Button (only visible when drying is active) -->
      <lv_button name="btn_stop_drying"
                 width="100%" height="#button_height" style_radius="#border_radius" style_border_width="0"
                 style_shadow_width="0" style_bg_color="#error_color">
        <!-- Hidden when NOT drying -->
        <bind_flag_if_eq subject="dryer_active" flag="hidden" ref_value="0"/>
        <text_body text="Stop Drying" align="center"/>
        <event_cb trigger="clicked" callback="dryer_stop_clicked_cb"/>
      </lv_button>
    </ui_card>
  </view>
</component>
