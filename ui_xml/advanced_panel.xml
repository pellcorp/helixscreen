<?xml version="1.0"?>
<!-- Copyright 2025 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->

<!-- Advanced Panel - Hub for advanced printer tools and calibration features -->
<!-- Organized in sections: Calibration, Motion, Filament, Automation -->
<!-- Features are conditionally shown based on printer capabilities -->
<component>
  <view extends="lv_obj" name="advanced_panel" width="100%" height="100%"
        style_bg_opa="0" style_border_width="0" style_pad_all="0" style_pad_gap="0"
        flex_flow="column" scrollable="true" scroll_dir="ver">

    <!-- ================================================================== -->
    <!-- CALIBRATION SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="CALIBRATION" icon="mat_build"/>

    <!-- Bed Leveling (always shown - handles capability check internally) -->
    <setting_action_row name="row_bed_leveling"
                        label="Bed Leveling"
                        icon="mat_bedmesh"
                        description="Auto mesh and manual screw adjustment"/>

    <!-- Input Shaping (hidden if no accelerometer) -->
    <lv_obj name="container_input_shaping" width="100%" height="content"
            style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false">
      <lv_obj-bind_flag_if_eq subject="printer_has_accelerometer" flag="hidden" ref_value="0"/>
      <setting_action_row name="row_input_shaping"
                          label="Input Shaping"
                          icon="mat_tune"
                          description="Resonance compensation tuning"/>
    </lv_obj>

    <!-- Z-Offset Calibration (hidden if no probe) -->
    <lv_obj name="container_z_offset" width="100%" height="content"
            style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false">
      <lv_obj-bind_flag_if_eq subject="printer_has_probe" flag="hidden" ref_value="0"/>
      <setting_action_row name="row_z_offset"
                          label="Z-Offset Calibration"
                          icon="mat_z_closer"
                          description="Interactive probe calibration"/>
    </lv_obj>

    <!-- ================================================================== -->
    <!-- MOTION SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="MOTION" icon="mat_speed"/>

    <!-- Machine Limits -->
    <setting_action_row name="row_machine_limits"
                        label="Machine Limits"
                        icon="mat_dashboard"
                        description="Velocity and acceleration limits"/>

    <!-- ================================================================== -->
    <!-- FILAMENT SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="FILAMENT" icon="mat_filament"/>

    <!-- Spoolman (hidden if not connected) -->
    <lv_obj name="container_spoolman" width="100%" height="content"
            style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false">
      <lv_obj-bind_flag_if_eq subject="printer_has_spoolman" flag="hidden" ref_value="0"/>
      <setting_action_row name="row_spoolman"
                          label="Spoolman"
                          icon="mat_inventory"
                          description="Filament tracking and inventory"/>
    </lv_obj>

    <!-- Fallback message when Spoolman not available -->
    <lv_obj name="container_no_spoolman" width="100%" height="content"
            style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false">
      <lv_obj-bind_flag_if_eq subject="printer_has_spoolman" flag="hidden" ref_value="1"/>
      <setting_info_row name="row_no_spoolman"
                        label="Spoolman"
                        icon="mat_inventory"
                        value="Not configured"/>
    </lv_obj>

    <!-- ================================================================== -->
    <!-- AUTOMATION SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="AUTOMATION" icon="mat_code"/>

    <!-- Macro Browser -->
    <setting_action_row name="row_macros"
                        label="Macro Browser"
                        icon="mat_terminal"
                        description="Execute printer macros"/>

    <!-- ================================================================== -->
    <!-- DIAGNOSTICS SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="DIAGNOSTICS" icon="mat_sysinfo"/>

    <!-- Console / G-code Terminal -->
    <setting_action_row name="row_console"
                        label="G-code Console"
                        icon="mat_terminal"
                        description="Send commands directly to printer"/>

    <!-- System Restart Options -->
    <setting_action_row name="row_restart"
                        label="Restart Options"
                        icon="mat_refresh"
                        description="Restart Klipper or firmware"/>

    <!-- Bottom padding for scroll -->
    <lv_obj width="100%" height="#padding_large" style_bg_opa="0" style_border_width="0" scrollable="false"/>

  </view>
</component>
